# Pet Service 产品需求文档

## 项目概述

Pet Service 是 Petify 宠物管理平台的核心服务之一，负责宠物档案管理、品种数据查询、健康记录维护等功能。作为平台的数据基础，为用户提供完整的宠物信息管理体验。

## 核心功能模块

### 1. 宠物档案管理

#### 1.1 宠物注册
- **功能描述**: 用户可以为自己的宠物创建详细档案
- **核心字段**:
  - 基本信息: 姓名、品种、性别、生日/年龄、体重
  - 外观特征: 毛色、体型、特殊标记
  - 个性特点: 性格、喜好、习惯
  - 联系信息: 紧急联系人、兽医信息
- **业务规则**: 
  - 每个用户可注册多只宠物
  - 宠物姓名在用户范围内不可重复
  - 必填字段: 姓名、品种、性别

#### 1.2 档案维护
- **功能描述**: 完整的宠物信息增删改查
- **核心功能**:
  - 更新宠物基本信息
  - 上传和管理宠物照片
  - 设置宠物头像
  - 记录体重变化历史
- **业务规则**:
  - 只有宠物主人可以修改档案
  - 删除宠物需要确认操作
  - 照片支持多张，单张大小限制5MB

#### 1.3 多宠物管理
- **功能描述**: 用户可以管理多只宠物，便捷切换查看
- **核心功能**:
  - 宠物列表展示
  - 快速切换宠物档案
  - 宠物状态标记(活跃/已故/寄养等)
- **业务规则**:
  - 支持宠物排序(按添加时间、姓名等)
  - 提供宠物搜索功能

### 2. 品种和分类体系

#### 2.1 品种库查询
- **功能描述**: 提供完整的宠物品种数据库
- **核心数据**:
  - 品种基本信息: 名称、分类、原产地
  - 外观特征: 体型、毛长、颜色变化
  - 性格特点: 活跃度、友好度、训练难度
  - 健康信息: 常见疾病、平均寿命、护理要点
- **查询方式**:
  - 按分类浏览
  - 关键词搜索
  - 特征筛选

#### 2.2 分类浏览
- **功能描述**: 层级化的宠物分类体系
- **分类结构**:
  ```
  宠物类型
  ├── 犬类
  │   ├── 大型犬
  │   ├── 中型犬
  │   └── 小型犬
  ├── 猫类
  │   ├── 长毛猫
  │   └── 短毛猫
  ├── 鸟类
  └── 其他小宠
  ```

#### 2.3 智能品种推荐
- **功能描述**: 基于宠物特征推荐可能的品种
- **推荐依据**:
  - 外观特征匹配
  - 用户描述的性格特点
  - 生活环境适应性
- **实现方式**: 
  - Phase 1: 基于关键词匹配
  - Phase 2: 图像识别(未来功能)

### 3. 健康档案系统

#### 3.1 疫苗管理
- **功能描述**: 完整的疫苗接种记录和提醒系统
- **核心功能**:
  - 疫苗接种记录
  - 疫苗计划制定
  - 到期提醒
  - 疫苗证书管理
- **疫苗类型**:
  - 核心疫苗: 狂犬病、犬瘟热等
  - 非核心疫苗: 根据地区和生活方式
  - 定制疫苗计划
- **提醒机制**:
  - 到期前30天、7天、当天提醒
  - 支持短信、邮件、应用内通知

#### 3.2 医疗记录
- **功能描述**: 完整的就医历史和健康档案
- **记录内容**:
  - 就诊信息: 日期、医院、医生、症状
  - 诊断结果: 诊断、治疗方案、处方
  - 用药记录: 药品名称、剂量、频次、疗程
  - 手术记录: 手术类型、日期、恢复情况
- **数据来源**:
  - 用户手动录入
  - 医院系统对接(未来功能)
  - 智能识别处方单(未来功能)

#### 3.3 健康提醒
- **功能描述**: 基于品种特征的个性化健康建议
- **提醒类型**:
  - 定期体检提醒
  - 季节性护理建议
  - 品种特有疾病预防
  - 年龄相关健康关注点
- **提醒频率**: 可配置，默认每月一次健康回顾

### 4. 宠物服务集成

#### 4.1 预约历史关联
- **功能描述**: 与appointment服务集成，展示宠物相关预约
- **展示内容**:
  - 历史预约记录
  - 即将到来的预约
  - 服务评价和反馈
- **集成方式**: 通过pet_id关联查询预约数据

#### 4.2 服务推荐
- **功能描述**: 基于宠物信息推荐适合的服务
- **推荐依据**:
  - 宠物品种特点
  - 年龄阶段需求
  - 健康状况
  - 历史服务偏好
- **推荐服务**:
  - 医疗服务: 体检、疫苗、绝育等
  - 美容服务: 洗澡、修毛、护理等
  - 培训服务: 基础训练、行为纠正等
  - 寄养服务: 短期寄养、长期托管等

## API设计规范

### 请求路径规范
所有Pet Service的API路径都以 `/api/pet` 开头，经过网关路由后实际服务接收的路径会去掉前缀。

### 宠物管理API

#### 宠物CRUD操作
```
POST   /pets              # 注册新宠物
GET    /pets              # 获取当前用户的宠物列表
GET    /pets/{petId}      # 获取指定宠物详情
PUT    /pets/{petId}      # 更新宠物信息
DELETE /pets/{petId}      # 删除宠物档案
```

#### 宠物照片管理
```
POST   /pets/{petId}/photos     # 上传宠物照片
GET    /pets/{petId}/photos     # 获取宠物照片列表
PUT    /pets/{petId}/avatar     # 设置宠物头像
DELETE /pets/{petId}/photos/{photoId}  # 删除指定照片
```

### 品种数据API

#### 分类和品种查询
```
GET    /categories               # 获取宠物分类树
GET    /categories/{categoryId}/breeds  # 获取指定分类下的品种
GET    /breeds                   # 搜索品种信息(支持关键词)
GET    /breeds/{breedId}         # 获取品种详情
POST   /breeds/recommend         # 品种推荐(基于特征描述)
```

### 健康档案API

#### 疫苗管理
```
GET    /pets/{petId}/vaccinations      # 获取疫苗记录
POST   /pets/{petId}/vaccinations      # 添加疫苗记录
PUT    /pets/{petId}/vaccinations/{vaccinationId}  # 更新疫苗记录
DELETE /pets/{petId}/vaccinations/{vaccinationId}  # 删除疫苗记录
GET    /pets/{petId}/vaccination-plan  # 获取疫苗计划
POST   /pets/{petId}/vaccination-plan  # 生成疫苗计划
```

#### 医疗记录
```
GET    /pets/{petId}/medical-records        # 获取医疗记录
POST   /pets/{petId}/medical-records        # 添加医疗记录
PUT    /pets/{petId}/medical-records/{recordId}  # 更新医疗记录
DELETE /pets/{petId}/medical-records/{recordId}  # 删除医疗记录
```

#### 健康提醒
```
GET    /pets/{petId}/health-reminders  # 获取健康提醒
POST   /pets/{petId}/health-reminders  # 创建健康提醒
PUT    /pets/{petId}/health-reminders/{reminderId}  # 更新提醒设置
```

## 数据模型设计

### 核心实体关系
```
User (1) ----< (N) Pet
Pet (1) ----< (N) PetVaccination
Pet (1) ----< (N) PetMedicalRecord
Pet (N) ----< (1) PetBreed
PetBreed (N) ----< (1) PetCategory
```

### 权限控制
- **宠物档案**: 只有宠物主人可以查看和修改
- **品种数据**: 所有用户可以查看
- **健康记录**: 只有宠物主人可以查看和修改
- **服务集成**: 需要验证用户对宠物的所有权

## 实现优先级

### Phase 1 - MVP核心功能
1. **宠物基础CRUD**: 注册、查看、更新、删除宠物档案
2. **品种查询**: 基础的品种数据查询和分类浏览
3. **简单疫苗记录**: 基本的疫苗接种记录功能
4. **用户认证集成**: 与User Service的JWT认证集成

### Phase 2 - 完善功能
1. **完整健康档案**: 医疗记录、健康提醒系统
2. **照片管理**: 宠物照片上传、头像设置
3. **预约集成**: 与Appointment Service的数据关联
4. **服务推荐**: 基于宠物信息的个性化推荐

### Phase 3 - 高级功能
1. **智能品种识别**: 基于照片的品种识别
2. **健康分析**: 基于数据的健康趋势分析
3. **社交功能**: 宠物社区、经验分享
4. **第三方集成**: 与兽医院、宠物用品商的系统对接

## 技术要求

### 依赖服务
- **User Service**: 用户身份验证、用户信息查询
- **Appointment Service**: 预约历史查询(可选集成)

### 外部依赖
- **文件存储**: 宠物照片存储(建议使用云存储服务)
- **消息推送**: 健康提醒和疫苗到期通知
- **缓存服务**: 品种数据缓存、用户宠物列表缓存

### 性能要求
- **响应时间**: API响应时间 < 500ms
- **并发量**: 支持1000+并发用户
- **数据一致性**: 确保宠物档案数据的准确性和完整性

## 成功指标

### 功能指标
- 宠物注册成功率 > 95%
- 品种查询准确率 > 90%
- 健康提醒及时性 > 95%

### 用户体验指标
- 宠物档案完成度 > 80%
- 用户活跃度(月活跃宠物档案查看) > 70%
- 功能使用满意度 > 4.0/5.0

### 技术指标
- 服务可用性 > 99.5%
- API响应时间 < 500ms
- 数据备份完整性 100%